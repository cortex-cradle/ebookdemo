<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Product Download Security Demo</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 50px; background-color: #f4f4f9; }
        .product-card { max-width: 400px; margin: 0 auto; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); background-color: #ffffff; }
        h1 { color: #333; }
        p { color: #666; margin-bottom: 30px; }
        .buy-button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; text-decoration: none; font-size: 1.1em; }
        
        /* Modal (Popup) CSS */
        .modal {
            display: none; 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); 
            z-index: 1000; overflow: auto;
            display: flex; /* Flexbox use kiya tak isse center kar sakein */
            align-items: center; justify-content: center;
        }
        .modal-content {
            background-color: #4CAF50; color: white; 
            padding: 30px; 
            border-radius: 10px; width: 80%; max-width: 400px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: fadeIn 0.5s;
        }
        .download-button {
            display: inline-block; background-color: #fff; color: #4CAF50;
            padding: 12px 25px; margin-top: 20px;
            text-decoration: none; border-radius: 5px;
            font-weight: bold; font-size: 1.2em;
        }
        @keyframes fadeIn {
            from {opacity: 0;}
            to {opacity: 1;}
        }
    </style>
</head>
<body>

    <div class="product-card">
        <h1>ðŸš€ My Secure Digital Product (Demo)</h1>
        <p>Yeh payment page hai. Payment ke baad aapko isi page par download link milega, jo chhipa rahega.</p>
        
        <button class="buy-button" onclick="alert('Demo: Payment Gateway open hoga. Successful payment ke baad, aapko neeche diye gaye URL se wapas aana hoga.')">Buy Now (Cashfree Demo)</button>
    </div>

    <div id="downloadModal" class="modal">
        <div class="modal-content">
            <h2>âœ… Success! Download Ready</h2>
            <p>Aapka payment safal ho gaya hai. Abhi download karein:</p>
            
            <a id="downloadButton" href="javascript:void(0)" class="download-button" download>Download Your eBook</a>
            
            <p style="margin-top:15px; font-size:0.8em;">(Yeh link tabhi kaam karega jab aap payment karenge)</p>
        </div>
    </div>

<script>
    // --- ðŸ”‘ STEP 1: CONFIGURATION SETTINGS ðŸ”‘ ---

    // 1. Google Drive se apni file ID yahan daalein.
    // NOTE: Yeh demo ID hai, aapko apni asli ID daalni hogi!
    const YOUR_FILE_ID = "1s0Z4t7k0XYvow07JChpAkB9iwkI6jrRa"; 
    
    // 2. Woh Secret Key jo aap Cashfree ke Redirect URL mein daalenge
    const REQUIRED_SECRET_KEY = 'MY_EBOOK_KEY_123'; 

    // FINAL DOWNLOAD LINK (Yeh link chhipa rahega)
    const ACTUAL_DOWNLOAD_LINK = `https://drive.google.com/uc?export=download&id=${YOUR_FILE_ID}`;
    
    // --- CORE LOGIC ---
    
    // Function to get query parameters from the URL
    function getUrlParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    // Check karein ki URL mein 'payment_status=success' aur 'secret_key' maujood hain
    const paymentStatus = getUrlParam('payment_status');
    const secretKey = getUrlParam('secret_key');

    if (paymentStatus === 'success' && secretKey === REQUIRED_SECRET_KEY) {
        
        // 1. Download Popup ko dikhayein aur link set karein
        showDownloadPopup(); 
        
        // 2. ***MAGIC HIDING STEP***: URL se query parameters hatayein
        // Yahi woh step hai jo user ke browser se secret key chhipata hai
        history.replaceState(null, null, location.pathname); 
    }


    function showDownloadPopup() {
        // Modal ko display karein
        document.getElementById('downloadModal').style.display = 'flex';
        
        // Download Button par click event listener lagaayein taaki link chhipa rahe
        const downloadBtn = document.getElementById('downloadButton');
        
        // Jab user button dabayega, tab download shuru hoga
        downloadBtn.onclick = function() {
            // Button dabne par, woh chhipa hua link naye tab mein open karein
            window.open(ACTUAL_DOWNLOAD_LINK, '_blank'); 
            
            // Optional: Popup band kar dein
            // document.getElementById('downloadModal').style.display = 'none';
        };
    }
</script>

</body>
</html>
